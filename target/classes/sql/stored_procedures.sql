-- Stored procedure cho bảng LOP

-- Lấy tất cả các lớp
CREATE OR ALTER PROCEDURE sp_LOP_GetAll
AS
BEGIN
    SELECT * FROM LOP
END
GO

-- Lấy lớp theo mã lớp
CREATE OR ALTER PROCEDURE sp_LOP_GetByMaLop
    @MALOP NCHAR(8)
AS
BEGIN
    SELECT * FROM LOP WHERE MALOP = @MALOP
END
GO

-- Lấy lớp theo tên lớp
CREATE OR ALTER PROCEDURE sp_LOP_GetByTenLop
    @TENLOP NVARCHAR(40)
AS
BEGIN
    SELECT * FROM LOP WHERE TENLOP = @TENLOP
END
GO

-- Thêm lớp mới
CREATE OR ALTER PROCEDURE sp_LOP_Insert
    @MALOP NCHAR(8),
    @TENLOP NVARCHAR(40)
AS
BEGIN
    INSERT INTO LOP (MALOP, TENLOP)
    VALUES (@MALOP, @TENLOP)
END
GO

-- Cập nhật lớp
CREATE OR ALTER PROCEDURE sp_LOP_Update
    @MALOP NCHAR(8),
    @TENLOP NVARCHAR(40)
AS
BEGIN
    UPDATE LOP
    SET TENLOP = @TENLOP
    WHERE MALOP = @MALOP
END
GO

-- Xóa lớp
CREATE OR ALTER PROCEDURE sp_LOP_Delete
    @MALOP NCHAR(8)
AS
BEGIN
    DELETE FROM LOP WHERE MALOP = @MALOP
END
GO

-- Stored procedure cho bảng MONHOC

-- Lấy tất cả các môn học
CREATE OR ALTER PROCEDURE sp_MONHOC_GetAll
AS
BEGIN
    SELECT * FROM MONHOC
END
GO

-- Lấy môn học theo mã môn học
CREATE OR ALTER PROCEDURE sp_MONHOC_GetByMaMH
    @MAMH NCHAR(5)
AS
BEGIN
    SELECT * FROM MONHOC WHERE MAMH = @MAMH
END
GO

-- Lấy môn học theo tên môn học
CREATE OR ALTER PROCEDURE sp_MONHOC_GetByTenMH
    @TENMH NVARCHAR(40)
AS
BEGIN
    SELECT * FROM MONHOC WHERE TENMH = @TENMH
END
GO

-- Thêm môn học mới
CREATE OR ALTER PROCEDURE sp_MONHOC_Insert
    @MAMH NCHAR(5),
    @TENMH NVARCHAR(40)
AS
BEGIN
    INSERT INTO MONHOC (MAMH, TENMH)
    VALUES (@MAMH, @TENMH)
END
GO

-- Cập nhật môn học
CREATE OR ALTER PROCEDURE sp_MONHOC_Update
    @MAMH NCHAR(5),
    @TENMH NVARCHAR(40)
AS
BEGIN
    UPDATE MONHOC
    SET TENMH = @TENMH
    WHERE MAMH = @MAMH
END
GO

-- Xóa môn học
CREATE OR ALTER PROCEDURE sp_MONHOC_Delete
    @MAMH NCHAR(5)
AS
BEGIN
    DELETE FROM MONHOC WHERE MAMH = @MAMH
END
GO

-- Stored procedure cho bảng SINHVIEN

-- Lấy tất cả sinh viên
CREATE OR ALTER PROCEDURE sp_SINHVIEN_GetAll
AS
BEGIN
    SELECT * FROM SINHVIEN
END
GO

-- Lấy sinh viên theo mã sinh viên
CREATE OR ALTER PROCEDURE sp_SINHVIEN_GetByMaSV
    @MASV NCHAR(8)
AS
BEGIN
    SELECT * FROM SINHVIEN WHERE MASV = @MASV
END
GO

-- Lấy sinh viên theo họ tên
CREATE OR ALTER PROCEDURE sp_SINHVIEN_GetByHoTen
    @HO NVARCHAR(40),
    @TEN NVARCHAR(10)
AS
BEGIN
    SELECT * FROM SINHVIEN WHERE HO = @HO AND TEN = @TEN
END
GO

-- Lấy sinh viên theo mã lớp
CREATE OR ALTER PROCEDURE sp_SINHVIEN_GetByMaLop
    @MALOP NCHAR(8)
AS
BEGIN
    SELECT * FROM SINHVIEN WHERE MALOP = @MALOP
END
GO

-- Thêm sinh viên mới
CREATE OR ALTER PROCEDURE sp_SINHVIEN_Insert
    @MASV NCHAR(8),
    @HO NVARCHAR(40),
    @TEN NVARCHAR(10),
    @NGAYSINH DATETIME,
    @DIACHI NVARCHAR(100),
    @MALOP NCHAR(8)
AS
BEGIN
    INSERT INTO SINHVIEN (MASV, HO, TEN, NGAYSINH, DIACHI, MALOP)
    VALUES (@MASV, @HO, @TEN, @NGAYSINH, @DIACHI, @MALOP)
END
GO

-- Cập nhật sinh viên
CREATE OR ALTER PROCEDURE sp_SINHVIEN_Update
    @MASV NCHAR(8),
    @HO NVARCHAR(40),
    @TEN NVARCHAR(10),
    @NGAYSINH DATETIME,
    @DIACHI NVARCHAR(100),
    @MALOP NCHAR(8)
AS
BEGIN
    UPDATE SINHVIEN
    SET HO = @HO,
        TEN = @TEN,
        NGAYSINH = @NGAYSINH,
        DIACHI = @DIACHI,
        MALOP = @MALOP
    WHERE MASV = @MASV
END
GO

-- Xóa sinh viên
CREATE OR ALTER PROCEDURE sp_SINHVIEN_Delete
    @MASV NCHAR(8)
AS
BEGIN
    DELETE FROM SINHVIEN WHERE MASV = @MASV
END
GO 